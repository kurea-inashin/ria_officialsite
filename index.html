function init() {
            // ローカルストレージからクリア状況を取得
            const cleared = JSON.parse(localStorage.getItem('clearedStages') || '[]');
            
            // 各ボタンにクリア済みクラスを付与
            const modes = ['ki', 'do', 'ai', 'raku', 'hidden'];
            modes.forEach(id => {
                const btn = document.getElementById('btn-' + id);
                if (btn) {
                    if (cleared.includes(id)) {
                        btn.classList.add('cleared');
                    } else {
                        btn.classList.remove('cleared');
                    }
                }
            });

            // 【ここを修正】隠しステージ（中央線）の出現条件を厳密に
            // 1. 管理者ログインで 'hidden' がクリア済みになっているか
            // 2. あるいは、通常プレイで ki, do, ai, raku の4つが揃っているか
            const standardRequired = ['ki', 'do', 'ai', 'raku'];
            const isStandardUnlocked = standardRequired.every(s => cleared.includes(s));
            const isAdminUnlocked = cleared.includes('hidden');

            const hiddenBtn = document.getElementById('btn-hidden');
            if (isStandardUnlocked || isAdminUnlocked) {
                hiddenBtn.style.display = 'block';
            } else {
                hiddenBtn.style.display = 'none';
            }
        }

        function adminLogin() {
            const pass = prompt("管理者パスワードを入力してください:");
            if (pass === "admin1234") {
                // 管理者として全解禁
                const allStages = ['ki', 'do', 'ai', 'raku', 'hidden'];
                localStorage.setItem('clearedStages', JSON.stringify(allStages));
                alert("ADMIN MODE: 全ステージを強制解禁しました。");
                init(); // 再読み込みせずにUIを更新
            } else {
                alert("パスワードが違います。");
            }
        }
